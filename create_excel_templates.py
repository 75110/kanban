#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
创建人事数据看板Excel模板文件
运行此脚本将生成三个Excel文件，包含完整的列名和示例数据
"""

import pandas as pd
from datetime import datetime
import os

def create_excel_templates():
    """创建Excel模板文件"""
    
    # 创建输出目录
    output_dir = "excel_templates"
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # 1. 员工花名册
    roster_columns = [
        "序列", "区域", "部门", "岗位", "名字", "性别", "民族", "政治面貌", 
        "员工性质", "险种", "出生日期", "生日", "入职时间", "实际转正日期", 
        "备注", "合同终止日期", "工龄（月）", "身份证号", "身份证地址", "年龄", 
        "籍贯", "毕业院校", "专业", "学历", "教育方式", "毕业日期", "面试官姓名", 
        "婚姻状况", "现居住地", "本人联系方式", "紧急联系人姓名", "紧急联系人电话", 
        "银行卡号", "详细支行信息", "劳动关系隶属(*)", "社保隶属(*)", 
        "竞业协议", "保密协议", "备注1"
    ]
    
    roster_data = [
        ["001", "总部", "技术部", "高级工程师", "张三", "男", "汉族", "党员", "正式员工", "五险一金", 
         "1990-05-15", "05-15", "2020-03-01", "2020-06-01", "", "2025-03-01", 45, 
         "110101199005150001", "北京市朝阳区", 33, "北京", "清华大学", "计算机科学与技术", "本科", 
         "全日制", "2012-06-30", "李经理", "已婚", "北京市朝阳区", "13800138001", "张父", 
         "13900139001", "6222021234567890", "中国银行朝阳支行", "总部", "总部", "是", "是", "技术骨干"],
        
        ["002", "杭州", "产品部", "产品经理", "李四", "女", "汉族", "群众", "正式员工", "五险一金", 
         "1992-08-20", "08-20", "2021-01-15", "2021-04-15", "", "2024-01-15", 32, 
         "330101199208200002", "浙江省杭州市西湖区", 31, "浙江杭州", "浙江大学", "工商管理", "硕士", 
         "全日制", "2015-06-30", "王总监", "未婚", "杭州市西湖区", "13800138002", "李母", 
         "13900139002", "6222021234567891", "工商银行杭州分行", "杭州分公司", "杭州分公司", "否", "是", "产品负责人"],
        
        ["003", "上海", "市场部", "市场专员", "王五", "男", "汉族", "团员", "正式员工", "五险一金", 
         "1995-12-10", "12-10", "2022-06-01", "2022-09-01", "", "2025-06-01", 18, 
         "310101199512100003", "上海市浦东新区", 28, "上海", "复旦大学", "市场营销", "本科", 
         "全日制", "2017-06-30", "陈主管", "未婚", "上海市浦东新区", "13800138003", "王父", 
         "13900139003", "6222021234567892", "建设银行上海分行", "上海分公司", "上海分公司", "否", "是", "市场新人"],
        
        ["004", "合肥", "人事部", "HR专员", "赵六", "女", "汉族", "群众", "正式员工", "五险一金", 
         "1993-03-25", "03-25", "2021-09-01", "2021-12-01", "", "2024-09-01", 27, 
         "340101199303250004", "安徽省合肥市蜀山区", 30, "安徽合肥", "安徽大学", "人力资源管理", "本科", 
         "全日制", "2015-06-30", "刘总", "已婚", "合肥市蜀山区", "13800138004", "赵母", 
         "13900139004", "6222021234567893", "农业银行合肥分行", "合肥分公司", "合肥分公司", "否", "是", "人事专员"],
        
        ["005", "宁波", "财务部", "会计", "钱七", "女", "汉族", "党员", "正式员工", "五险一金", 
         "1988-11-08", "11-08", "2019-05-01", "2019-08-01", "", "2024-05-01", 54, 
         "330201198811080005", "浙江省宁波市海曙区", 35, "浙江宁波", "宁波大学", "会计学", "本科", 
         "全日制", "2010-06-30", "孙经理", "已婚", "宁波市海曙区", "13800138005", "钱父", 
         "13900139005", "6222021234567894", "交通银行宁波分行", "宁波分公司", "宁波分公司", "否", "是", "财务骨干"],
        
        ["006", "义乌", "销售部", "销售代表", "孙八", "男", "汉族", "群众", "正式员工", "五险一金", 
         "1996-07-18", "07-18", "2023-02-01", "2023-05-01", "", "2026-02-01", 10, 
         "330782199607180006", "浙江省义乌市稠城街道", 27, "浙江义乌", "义乌工商学院", "国际贸易", "大专", 
         "全日制", "2018-06-30", "周主管", "未婚", "义乌市稠城街道", "13800138006", "孙母", 
         "13900139006", "6222021234567895", "邮储银行义乌支行", "义乌分公司", "义乌分公司", "否", "否", "销售新人"],
        
        ["007", "总部", "技术部", "初级工程师", "周九", "男", "汉族", "团员", "实习生", "五险", 
         "1998-04-12", "04-12", "2023-07-01", "", "", "", 5, 
         "110101199804120007", "北京市海淀区", 25, "北京", "北京理工大学", "软件工程", "本科", 
         "全日制", "2020-06-30", "李经理", "未婚", "北京市海淀区", "13800138007", "周父", 
         "13900139007", "6222021234567896", "招商银行北京分行", "总部", "总部", "否", "否", "实习生"],
        
        ["008", "杭州", "设计部", "UI设计师", "吴十", "女", "汉族", "群众", "正式员工", "五险一金", 
         "1994-09-30", "09-30", "2022-03-01", "2022-06-01", "", "2025-03-01", 21, 
         "330101199409300008", "浙江省杭州市滨江区", 29, "浙江杭州", "中国美术学院", "视觉传达设计", "本科", 
         "全日制", "2016-06-30", "郑总监", "未婚", "杭州市滨江区", "13800138008", "吴母", 
         "13900139008", "6222021234567897", "光大银行杭州分行", "杭州分公司", "杭州分公司", "否", "是", "设计师"]
    ]
    
    # 2. 离职监控表
    resignation_columns = [
        "序列", "区域", "部门", "岗位", "姓名", "性别", "民族", "政治面貌", 
        "员工性质", "险种", "出生日期", "生日", "入职时间", "实际转正日期", 
        "备注", "合同终止日期", "工龄（月）", "身份证号", "身份证地址", "年龄", 
        "籍贯", "毕业院校", "专业", "学历", "教育方式", "毕业日期", "面试官姓名", 
        "婚姻状况", "现居住地", "本人联系方式", "紧急联系人姓名", "紧急联系人电话", 
        "银行卡号", "详细支行信息", "劳动关系隶属(*)", "社保隶属(*)", 
        "竞业协议", "保密协议", "离职时间", "离职类型", "离职原因", "备注"
    ]
    
    resignation_data = [
        ["009", "上海", "技术部", "高级工程师", "郑十一", "男", "汉族", "党员", "正式员工", "五险一金", 
         "1987-06-15", "06-15", "2018-03-01", "2018-06-01", "", "2023-11-30", 68, 
         "310101198706150009", "上海市徐汇区", 36, "上海", "上海交通大学", "计算机科学与技术", "硕士", 
         "全日制", "2010-06-30", "李经理", "已婚", "上海市徐汇区", "13800138009", "郑父", 
         "13900139009", "6222021234567898", "中国银行上海分行", "上海分公司", "上海分公司", "是", "是", 
         "2023-11-30", "主动离职", "个人发展", "寻求更好发展机会"],
        
        ["010", "合肥", "市场部", "市场经理", "王十二", "女", "汉族", "群众", "正式员工", "五险一金", 
         "1985-12-20", "12-20", "2017-01-15", "2017-04-15", "", "2023-10-15", 82, 
         "340101198512200010", "安徽省合肥市庐阳区", 38, "安徽合肥", "中南财经政法大学", "市场营销", "本科", 
         "全日制", "2008-06-30", "张总", "已婚", "合肥市庐阳区", "13800138010", "王母", 
         "13900139010", "6222021234567899", "工商银行合肥分行", "合肥分公司", "合肥分公司", "否", "是", 
         "2023-10-15", "协商离职", "家庭原因", "需要照顾家庭"],
        
        ["011", "宁波", "销售部", "销售主管", "李十三", "男", "汉族", "团员", "正式员工", "五险一金", 
         "1990-08-08", "08-08", "2019-06-01", "2019-09-01", "", "2023-12-01", 52, 
         "330201199008080011", "浙江省宁波市江北区", 33, "浙江宁波", "宁波大学", "工商管理", "本科", 
         "全日制", "2012-06-30", "陈经理", "已婚", "宁波市江北区", "13800138011", "李父", 
         "13900139011", "6222021234567900", "建设银行宁波分行", "宁波分公司", "宁波分公司", "否", "是", 
         "2023-12-01", "被动离职", "业绩不达标", "连续三个月未完成业绩"],
        
        ["012", "义乌", "人事部", "人事助理", "刘十四", "女", "汉族", "群众", "正式员工", "五险一金", 
         "1997-02-14", "02-14", "2022-08-01", "2022-11-01", "", "2023-09-30", 13, 
         "330782199702140012", "浙江省义乌市北苑街道", 26, "浙江义乌", "浙江师范大学", "人力资源管理", "本科", 
         "全日制", "2019-06-30", "赵主管", "未婚", "义乌市北苑街道", "13800138012", "刘母", 
         "13900139012", "6222021234567901", "农业银行义乌支行", "义乌分公司", "义乌分公司", "否", "否", 
         "2023-09-30", "主动离职", "职业规划", "转行发展"],
        
        ["013", "总部", "财务部", "出纳", "陈十五", "男", "汉族", "团员", "正式员工", "五险一金", 
         "1991-11-25", "11-25", "2020-12-01", "2021-03-01", "", "2023-08-15", 32, 
         "110101199111250013", "北京市丰台区", 32, "北京", "首都经济贸易大学", "会计学", "本科", 
         "全日制", "2013-06-30", "钱经理", "已婚", "北京市丰台区", "13800138013", "陈父", 
         "13900139013", "6222021234567902", "交通银行北京分行", "总部", "总部", "否", "是", 
         "2023-08-15", "协商离职", "薪资待遇", "薪资不符合预期"]
    ]
    
    # 3. 人员异动明细
    changes_columns = ["部门", "姓名", "原岗位", "新岗位", "异动时间", "异动原因（调动/晋升/降职）", "备注"]
    
    changes_data = [
        ["技术部", "张三", "中级工程师", "高级工程师", "2023-01-01", "晋升", "技术能力突出，工作表现优秀，获得团队一致认可"],
        ["产品部", "李四", "产品专员", "产品经理", "2023-03-15", "晋升", "产品规划能力强，团队协作良好，具备管理潜质"],
        ["市场部", "王五", "市场助理", "市场专员", "2023-06-01", "晋升", "市场分析能力提升，客户维护良好，业绩表现突出"],
        ["人事部", "赵六", "人事助理", "HR专员", "2022-12-01", "晋升", "人事工作经验丰富，沟通能力强，处理问题得当"],
        ["财务部", "钱七", "出纳", "会计", "2022-08-01", "调动", "财务专业能力强，适合会计岗位，有相关资格证书"],
        ["销售部", "孙八", "销售助理", "销售代表", "2023-05-01", "晋升", "销售业绩良好，客户关系维护佳，具备独立开发能力"],
        ["设计部", "吴十", "设计助理", "UI设计师", "2022-09-01", "晋升", "设计能力突出，创意思维活跃，作品质量高"],
        ["技术部", "周九", "实习生", "初级工程师", "2023-10-01", "晋升", "实习期表现优秀，技术基础扎实，正式转正"],
        ["市场部", "郑十一", "市场专员", "市场主管", "2023-02-01", "晋升", "市场开拓能力强，团队管理经验丰富"],
        ["人事部", "王十二", "HR专员", "人事主管", "2023-04-01", "晋升", "人事管理能力突出，制度建设贡献大"],
        ["财务部", "李十三", "会计", "财务主管", "2023-07-01", "晋升", "财务分析能力强，风险控制意识好"],
        ["销售部", "刘十四", "销售代表", "销售主管", "2023-08-01", "晋升", "销售业绩优秀，团队带领能力强"],
        ["技术部", "陈十五", "高级工程师", "技术经理", "2023-09-01", "晋升", "技术架构能力强，项目管理经验丰富"],
        ["产品部", "张十六", "产品经理", "产品总监", "2023-11-01", "晋升", "产品战略规划能力突出，跨部门协调能力强"],
        ["市场部", "李十七", "市场主管", "市场经理", "2023-12-01", "晋升", "市场策略制定能力强，执行力优秀"]
    ]
    
    # 创建Excel文件
    try:
        # 员工花名册
        df_roster = pd.DataFrame(roster_data, columns=roster_columns)
        roster_file = os.path.join(output_dir, "员工花名册.xlsx")
        df_roster.to_excel(roster_file, index=False, sheet_name="员工花名册")
        print(f"✅ 已创建: {roster_file}")
        
        # 离职监控表
        df_resignation = pd.DataFrame(resignation_data, columns=resignation_columns)
        resignation_file = os.path.join(output_dir, "离职监控表.xlsx")
        df_resignation.to_excel(resignation_file, index=False, sheet_name="离职监控表")
        print(f"✅ 已创建: {resignation_file}")
        
        # 人员异动明细
        df_changes = pd.DataFrame(changes_data, columns=changes_columns)
        changes_file = os.path.join(output_dir, "人员异动明细.xlsx")
        df_changes.to_excel(changes_file, index=False, sheet_name="人员异动明细")
        print(f"✅ 已创建: {changes_file}")
        
        print("\n🎉 所有Excel模板文件创建完成！")
        print("📁 文件位置: excel_templates/ 目录")
        print("\n📋 包含的文件:")
        print("   1. 员工花名册.xlsx - 包含39个字段的完整员工信息")
        print("   2. 离职监控表.xlsx - 包含42个字段的离职员工信息")
        print("   3. 人员异动明细.xlsx - 包含7个字段的异动记录")
        print("\n💡 提示: 这些文件可以直接用Excel打开，不会有乱码问题！")
        
    except ImportError:
        print("❌ 错误: 需要安装pandas库")
        print("请运行: pip install pandas openpyxl")
        print("然后重新运行此脚本")
    except Exception as e:
        print(f"❌ 创建文件时出错: {e}")

if __name__ == "__main__":
    create_excel_templates()
